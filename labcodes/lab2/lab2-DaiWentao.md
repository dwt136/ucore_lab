# Lab2 report

## 练习1
练习1.1. 请在实验报告中简要说明你的设计实现过程。
```
在alloc时，如果找到可以容纳的块，若有多余的空间，则将其切开，设置property位为1，并加到原来块的link后面，然后再删去原来的link。 在free时，找到第一个page地址比这一块大的（或在链表尾部），在它前面插入这个link。 然后合并周围的块，如果前面或者后面有相邻的块，那么可以进行合并。
```

练习1.2. 你的first fit算法是否有进一步的改进空间
```
有性能可以优化的地方。
```


## 练习2
练习2.1. 请在实验报告中简要说明你的设计实现过程。
```
首先得到一级页表对应项，检查是否有效，若无效则需新建页面再返回二级页表项，否则直接返回。 新建页面的时候，向管理器申请一个页面，如果不允许申请或者申请失败则返回空指针。然后清空该页，作为这个页目录项指向的二级页表。 得到这个页表的地址之后，在页目录项填入其起始地址和权限位即可。
```

练习2.2. 请描述页目录项（Pag Director Entry）和页表（Page Table Entry）中每个组成部分的含义和以及对ucore而言的潜在用处。
```
PDE中有对应的二级页表基地址，以及三个权限位：是否有效、可写、可被用户访问；PTE中有对应页的物理基地址，以及两个权限位：是否有效、可写。 这些权限位用于判断页面是否存在，用来管理内存以及保护数据。
```

练习2.3. 如果ucore执行过程中访问内存，出现了页访问异常，请问硬件要做哪些事情？
```
如果出现了页访问异常，硬件需要对硬盘发出信号，在内存和硬盘之间交换数据。
```


## 练习3
练习3.1. 请在实验报告中简要说明你的设计实现过程。
```
判断该二级页表是否有效，无效则直接退出。否则把它所指向的页的引用次数减一，如果到引用次数0就释放该页。 然后把二级页表项清零，最后刷新tlb。
```

练习3.2. 数据结构Page的全局变量（其实是一个数组）的每一项与页表中的页目录项和页表项有无对应关系？如果有，其对应关系是啥？
```
有对应关系，页表是从end开始的连续一段内存存放的。
```

练习3.3. 如果希望虚拟地址与物理地址相等，则需要如何修改lab2，完成此事？ 鼓励通过编程来具体完成这个问题
```
令gcc编译出的虚拟起始地址从0x100000开始。
```
